SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
semTools::reliability(model_valid_SES2)
modindices(model_valid_SES2, sort = T,maximum.number = 5)
valid_SES2 <- "v_SES =~ SES1 + SES2 +
SES3_r + SES4 + SES5_r + SES6 + SES7 +
SES8 + SES9_r + SES10_r
SES9_r ~~ SES10_r
SES3_r	~~	SES5_r
SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
SES7	~~	SES10_r
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
semTools::reliability(model_valid_SES2)
modindices(model_valid_SES2, sort = T,maximum.number = 5)
valid_SES2 <- "v_SES =~ SES1 + SES2 +
SES3_r + SES4 + SES5_r + SES6 + SES7 +
SES8 + SES9_r + SES10_r
SES9_r ~~ SES10_r
SES3_r	~~	SES5_r
SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
SES7	~~	SES10_r
SES7	~~	SES9_r
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
semTools::reliability(model_valid_SES2)
modindices(model_valid_SES2, sort = T,maximum.number = 5)
valid_SES2 <- "v_SES =~ SES1 + SES2 +
SES3_r + SES4 + SES5_r + SES6 + SES7 +
SES8 + SES9_r + SES10_r
SES9_r ~~ SES10_r
SES3_r	~~	SES5_r
SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
SES7	~~	SES10_r
SES7	~~	SES9_r
SES1	~~	SES9_r
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
semTools::reliability(model_valid_SES2)
modindices(model_valid_SES2, sort = T,maximum.number = 5)
valid_SES2 <- "v_SES =~ SES1 + SES2 +
SES3_r + SES4 + SES5_r + SES6 + SES7 +
SES8 + SES9_r + SES10_r
SES9_r ~~ SES10_r
SES3_r	~~	SES5_r
SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
SES7	~~	SES10_r
SES7	~~	SES9_r
SES1	~~	SES9_r
SES1	~~	SES8
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
semTools::reliability(model_valid_SES2)
modindices(model_valid_SES2, sort = T,maximum.number = 5)
valid_SES2 <- "v_SES =~ SES1 + SES2 +
SES3_r + SES4 + SES5_r + SES6 + SES7 +
SES8 + SES9_r + SES10_r
SES9_r ~~ SES10_r
SES3_r	~~	SES5_r
SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
SES7	~~	SES10_r
SES7	~~	SES9_r
SES1	~~	SES9_r
SES1	~~	SES8
SES2	~~	SES8
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
valid_SES2 <- "v_SES =~ SES1 + SES2 +
SES3_r + SES4 + SES5_r + SES6 + SES7 +
SES8 + SES9_r + SES10_r
SES9_r ~~ SES10_r
SES3_r	~~	SES5_r
SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
SES7	~~	SES10_r
SES7	~~	SES9_r
SES1	~~	SES9_r
SES1	~~	SES8
SES2	~~	SES8
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
semTools::reliability(model_valid_SES2)
modindices(model_valid_SES2, sort = T,maximum.number = 5)
valid_SES2 <- "v_SES =~ SES1 + SES2 +
SES3_r + SES4 + SES5_r + SES6 + SES7 +
SES8 + SES9_r + SES10_r
SES9_r ~~ SES10_r
SES3_r	~~	SES5_r
SES6	~~	SES7
SES8	~~	SES10_r
SES8	~~	SES9_r
SES3_r	~~	SES10_r
SES3_r	~~	SES9_r
SES5_r	~~	SES9_r
SES5_r	~~	SES10_r
SES4	~~	SES6
SES5_r	~~	SES8
SES3_r	~~	SES8
SES7	~~	SES10_r
SES7	~~	SES9_r
SES1	~~	SES9_r
SES1	~~	SES8
SES2	~~	SES8
SES2	~~	SES5_r
"
model_valid_SES2 <- cfa(valid_SES2, data = df1)
fitMeasures(model_valid_SES2,
c("chisq", "df", "pvalue",
"cfi", "rmsea", "tli", 'srmr'))
semTools::reliability(model_valid_SES2)
modindices(model_valid_SES2, sort = T,maximum.number = 5)
######################
library(tidyverse)
ttestf <- function(mean1, sd1, mean2, sd2, num_id, tirals, repli){
p <- numeric(repli)
d <- numeric(repli)
for (i in 1:repli) {
df <- data.frame(sub_id = rep(1:num_id, each = tirals),
x = rnorm(num_id,mean1,sd1),
y = rnorm(num_id,mean2,sd2))
df_longer <- df %>% pivot_longer(x:y, names_to = "group", values_to = "value")
p[i] <- t.test(value ~ group, data = df_longer)$p.value
d[i] <- effectsize::cohens_d(value ~ group, data = df_longer)[,1]
}
psum <- sum(p<0.05)/repli
mean_d <- mean(d)
return(as.data.frame(psum,mean_d))
}
ttestf(1.2, 1, 1, 1, 30, 20, 1000)
ttestf(1.2, 1, 1, 1, 30, 20, 100)
mean_d <- mean(1+1)
mean_d
psum <- sum(1+1)
psum <- sum(3+1)
as.data.frame(psum,mean_d)
as.data.frame((psum,mean_d))
as.data.frame(c(psum,mean_d))
as.tibble(c(psum,mean_d))
as.tibble(psum,mean_d)
as.tibble(psum,mean_d)
tibble(psum,mean_d)
ttestf <- function(mean1, sd1, mean2, sd2, num_id, tirals, repli){
p <- numeric(repli)
d <- numeric(repli)
for (i in 1:repli) {
df <- data.frame(sub_id = rep(1:num_id, each = tirals),
x = rnorm(num_id,mean1,sd1),
y = rnorm(num_id,mean2,sd2))
df_longer <- df %>% pivot_longer(x:y, names_to = "group", values_to = "value")
p[i] <- t.test(value ~ group, data = df_longer)$p.value
d[i] <- effectsize::cohens_d(value ~ group, data = df_longer)[,1]
}
psum <- sum(p<0.05)/repli
mean_d <- mean(d)
return(data.frame(psum,mean_d))
}
ttestf(1.2, 1, 1, 1, 30, 20, 100)
a <- ttestf(1.2, 1, 1, 1, 30, 20, 100)
a
power_t.test <- data.frame(psum,mean_d)
ttestf <- function(mean1, sd1, mean2, sd2, num_id, tirals, repli){
p <- numeric(repli)
d <- numeric(repli)
for (i in 1:repli) {
df <- data.frame(sub_id = rep(1:num_id, each = tirals),
x = rnorm(num_id,mean1,sd1),
y = rnorm(num_id,mean2,sd2))
df_longer <- df %>% pivot_longer(x:y, names_to = "group", values_to = "value")
p[i] <- t.test(value ~ group, data = df_longer)$p.value
d[i] <- effectsize::cohens_d(value ~ group, data = df_longer)[,1]
}
psum <- sum(p<0.05)/repli
mean_d <- mean(d)
power_t.test <- data.frame(psum,mean_d)
return( power_t.test)
}
ttestf(1.2, 1, 1, 1, 30, 20, 100)
a <- ttestf(1.2, 1, 1, 1, 30, 20, 100)
a
a %>% glimpse()
a %>%str()
n <- 1e5
group_TI <-  rnorm(n, 43, 15)
group_VI <-  rnorm(n, 40, 15)
group_TE <-  rnorm(n, 45, 15)
group_VE <-  rnorm(n, 47, 15)
participant <- c(1:(n*4))
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media, score = c(group_TI, group_VI, group_TE, group_VE))
aov_dat
aov_dat <- data.frame(participant = participant, focus = focus, media = media, score = c(group_TI, group_VI, group_TE, group_VE))
aov_car(score ~ focus*media+ Error(participant), data = aov_dat, type = 3)
afex::aov_car(score ~ focus*media+ Error(participant), data = aov_dat, type = 3)
n <- 20
group_TI <-  rnorm(n, 43, 15)
group_VI <-  rnorm(n, 40, 15)
group_TE <-  rnorm(n, 45, 15)
group_VE <-  rnorm(n, 47, 15)
participant <- c(1:(n*4))
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media, score = c(group_TI, group_VI, group_TE, group_VE))
afex::aov_car(score ~ focus*media+ Error(participant), data = aov_dat, type = 3)
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 20
FA_1 <-  rnorm(n, 43, 15)
FA_2 <-  rnorm(n, 40, 15)
FB_1<-  rnorm(n, 45, 15)
FB_2 <-  rnorm(n, 47, 15)
participant <- c(1:(n*4))
focus <- rep(c("internal", "external"), each = n*2)
n <- 5
group_TI <-  rnorm(n, 43, 15)
group_VI <-  rnorm(n, 40, 15)
group_TE <-  rnorm(n, 45, 15)
group_VE <-  rnorm(n, 47, 15)
participant <- c(1:(n*4))
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media, score = c(group_TI, group_VI, group_TE, group_VE))
aov_dat
c(1:(n*4))
aov_dat
participant2 <-  rep(1:n, each = 2)
participant2
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media, score = c(group_TI, group_VI, group_TE, group_VE))
aov_dat
aov_dat <- data.frame(participant = participant2, focus = focus, media = media, score = c(group_TI, group_VI, group_TE, group_VE))
aov_dat
participant2 <-  rep(1:n, each = 4)
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant2, focus = focus, media = media, score = c(group_TI, group_VI, group_TE, group_VE))
aov_dat
n <- 5
group_TI <-  rnorm(n, 43, 15)
group_VI <-  rnorm(n, 40, 15)
group_TE <-  rnorm(n, 45, 15)
group_VE <-  rnorm(n, 47, 15)
participant <- c(1:(n*4))
participant
rep(1:n, each = 4)
participant <- c(1:(n*4))
participant2 <-  rep(1:n, each = 4)
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant2, focus = focus, media = media)
aov_dat
participant <- c(1:(n*4))
participant2 <-  rep(1:n, each = 4)
GVT_1 <- rep(c("internal", "text"), each = n*2)
GVT_2 <- rep(c("external", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant2, focus = focus, media = media)
aov_dat
participant <- c(1:(n*4))
participant2 <-  rep(1:n, each = 4)
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant2, focus = focus, media = media)
aov_dat
participant2 <-  rep(1:n, times = 4)
participant2
participant2 <-  rep(1:n, times = 4)
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant2, focus = focus, media = media)
aov_dat
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 5
group_TI <-  rnorm_fixed (n, 43, 15)
group_VI <-  rnorm_fixed (n, 40, 15)
group_TE <-  rnorm_fixed (n, 45, 15)
group_VE <-  rnorm_fixed (n, 47, 15)
participant <- c(1:(n*4))
participant2 <-  rep(1:n, times = 4)
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant2, focus = focus, media = media)
aov_dat
aov_dat <- data.frame(participant = participant2, focus = focus, media = media,
score = c(group_TI, group_VI, group_TE, group_VE))
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean())
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean(score))
aov_dat %>% group_by(focus) %>% summarise(mean = mean(score))
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean(score))
aov_dat
aov_car(score ~ focus*media+ Error(participant), data = aov_dat, type = 3)
afex::aov_car(score ~ focus*media+ Error(participant), data = aov_dat, type = 3)
afex::aov_car(score ~ focus*media+ Error(participant2), data = aov_dat, type = 3)
afex::aov_car(score ~ focus*media+ Error(participant), data = aov_dat, type = 3)
aov <- aov_ez('participant', 'score', fun_aggregate = mean,
df, within = c('focus', 'media'))
aov <- afex::aov_ez('participant', 'score', fun_aggregate = mean,
df, within = c('focus', 'media'))
print(aov)
aov <- afex::aov_ez('participant', 'score', fun_aggregate = mean,
df, within = c('focus', 'media'))
aov_dat
aov <- afex::aov_ez('participant', 'score', fun_aggregate = mean,
aov_dat, within = c('focus', 'media'))
print(aov)
emmeans::emmeans(aov, ~focus|media)
subj <-  rep(1:n, times = 4)
focus <- rep(c("internal", "external"), each = n*2)
subj
subj
aov_dat
rnorm_fixed (n, 43,0)
FA_1 <-  rnorm_fixed (n, 43,0)
FB_1 <-  rnorm_fixed (n, 40, 0)
FA_2 <-  rnorm_fixed (n, 45, 0)
FB_2 <-  rnorm_fixed (n, 47, 0)
subj <-  rep(1:n, times = 4)
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(subj_id = subj, focus = focus, media = media,
score = c(group_TI, group_VI, group_TE, group_VE))
aov_dat
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 20
FA_1 <-  rnorm(n, 43, 15)
FA_2 <-  rnorm(n, 40, 15)
FB_1<-  rnorm(n, 45, 15)
FB_2 <-  rnorm(n, 47, 15)
participant <- c(1:(n*4))
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media, score = c(FA_1, FA_2, FB_1, FB_2))
aov_dat
aov_dat
FA_1
rnorm(n, 43, 15)
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 5
FA_1 <-  rnorm_fixed (n, 43,0)
FB_1 <-  rnorm_fixed (n, 40, 0)
FA_2 <-  rnorm_fixed (n, 45, 0)
FB_2 <-  rnorm_fixed (n, 47, 0)
subj <-  rep(1:n, times = 4)
focus <- rep(c("internal", "external"), each = n*2)
media <- rep(c("text", "visual"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media,
score = c(FA_1, FA_2, FB_1, FB_2))
aov_dat
focus <- rep(c("FA1", "FA2"), each = n*2)
media <- rep(c("FB1", "FB2"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media,
score = c(FA_1, FA_2, FB_1, FB_2))
aov_dat
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 5
FA1B1 <-  rnorm_fixed (n, 43,0)
FB_1 <-  rnorm_fixed (n, 40, 0)
FA1B2 <-  rnorm_fixed (n, 45, 0)
FB_2 <-  rnorm_fixed (n, 47, 0)
subj <-  rep(1:n, times = 4)
FA <- rep(c("FA1", "FA2"), each = n*2)
FB <- rep(c("FB1", "FB2"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media,
score = c(FA_1, FA_2, FB_1, FB_2))
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean(score))
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 5
FA1B1 <-  rnorm_fixed (n, 43,0)
FA2B1 <-  rnorm_fixed (n, 40, 0)
FA1B2 <-  rnorm_fixed (n, 45, 0)
FA2B2 <-  rnorm_fixed (n, 47, 0)
subj <-  rep(1:n, times = 4)
FA <- rep(c("FA1", "FA2"), each = n*2)
FB <- rep(c("FB1", "FB2"), each = n, times = 2)
aov_dat <- data.frame(participant = participant, focus = focus, media = media,
score = c(FA_1, FA_2, FB_1, FB_2))
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean(score))
aov_dat
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 5
FA1B1 <-  rnorm_fixed (n, 43,0)
FA2B1 <-  rnorm_fixed (n, 40, 0)
FA1B2 <-  rnorm_fixed (n, 45, 0)
FA2B2 <-  rnorm_fixed (n, 47, 0)
subj <-  rep(1:n, times = 4)
FA <- rep(c("FA1", "FA2"), each = n*2)
FB <- rep(c("FB1", "FB2"), each = n, times = 2)
aov_dat <- data.frame(participant = subj , focus = focus, media = media,
score = c(FA_1, FA_2, FB_1, FB_2))
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean(score))
aov <- afex::aov_ez('participant', 'score', fun_aggregate = mean,
aov_dat, within = c('FA', 'F2'))
aov_dat
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 5
FA1B1 <-  rnorm_fixed (n, 43,0)
FA2B1 <-  rnorm_fixed (n, 40, 0)
FA1B2 <-  rnorm_fixed (n, 45, 0)
FA2B2 <-  rnorm_fixed (n, 47, 0)
subj <-  rep(1:n, times = 4)
FA <- rep(c("FA1", "FA2"), each = n*2)
FB <- rep(c("FB1", "FB2"), each = n, times = 2)
aov_dat <- data.frame(subj_id = subj , focus = focus, media = media,
value = c(FA_1, FA_2, FB_1, FB_2))
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean(score))
aov <- afex::aov_ez('subj_id', 'value', fun_aggregate = mean,
aov_dat, within = c('FA', 'F2'))
aov_dat <- data.frame(subj_id = subj , focus = focus, media = media,
value = c(FA_1, FA_2, FB_1, FB_2))
aov_dat %>% group_by(focus, media) %>% summarise(mean = mean(score))
aov_dat %>% group_by(FA, FB) %>% summarise(mean = mean(score))
aov_dat %>% group_by(FA, FB) %>% summarise(mean = mean(value))
aov_dat
rnorm_fixed <- function(n,mean,sd) {mean+sd*scale(rnorm(n))}
n <- 5
FA1B1 <-  rnorm_fixed (n, 43,0)
FA2B1 <-  rnorm_fixed (n, 40, 0)
FA1B2 <-  rnorm_fixed (n, 45, 0)
FA2B2 <-  rnorm_fixed (n, 47, 0)
subj <-  rep(1:n, times = 4)
FA <- rep(c("FA1", "FA2"), each = n*2)
FB <- rep(c("FB1", "FB2"), each = n, times = 2)
aov_dat <- data.frame(subj_id = subj , FA = FA, FB = FB,
value = c(FA_1, FA_2, FB_1, FB_2))
aov_dat %>% group_by(FA, FB) %>% summarise(mean = mean(value))
aov <- afex::aov_ez('subj_id', 'value', fun_aggregate = mean,
aov_dat, within = c('FA', 'FB'))
print(aov)
